<!DOCTYPE html>
<html>
<head>
  <title>–í–∑–ª–æ–º —Å–∏—Å—Ç–µ–º—ã</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      background: #0a0f1e;
      color: #00ff9d;
      font-family: 'Courier New', monospace;
      padding: 20px;
    }
    
    .terminal {
      background: #0d1117;
      border: 2px solid #00ff9d;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 20px rgba(0, 255, 157, 0.3);
    }
    
    .code-line {
      display: flex;
      margin: 15px 0;
      align-items: center;
      gap: 10px;
      padding: 8px;
      border-left: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .code-line:hover {
      background: rgba(0, 255, 157, 0.1);
      border-left: 3px solid #00ff9d;
    }
    
    .code-line.selected {
      background: rgba(0, 255, 157, 0.2);
      border-left: 3px solid #ff3366;
    }
    
    .difficulty {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }
    
    .difficulty-btn {
      flex: 1;
      padding: 12px;
      border: 1px solid;
      background: transparent;
      color: inherit;
      font-family: inherit;
      cursor: pointer;
      transition: 0.2s;
    }
    
    .difficulty-btn[data-level="easy"] {
      border-color: #00ff9d;
      color: #00ff9d;
    }
    
    .difficulty-btn[data-level="medium"] {
      border-color: #ffaa00;
      color: #ffaa00;
    }
    
    .difficulty-btn[data-level="hard"] {
      border-color: #ff3366;
      color: #ff3366;
    }
    
    .difficulty-btn.active {
      background: currentColor;
      color: #0a0f1e;
    }
    
    .hack-btn {
      width: 100%;
      padding: 15px;
      margin-top: 20px;
      background: #00ff9d;
      border: none;
      color: #0a0f1e;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      border-radius: 5px;
    }
    
    .hack-btn:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }
    
    .progress-bar {
      width: 100%;
      height: 4px;
      background: #1a1f2a;
      margin: 20px 0;
      border-radius: 2px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: #00ff9d;
      width: 0%;
      transition: width 0.3s;
    }
    
    .hint {
      color: #888;
      font-size: 12px;
      margin-top: 20px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="terminal">
    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
      <span>üîê SENTINEL v7.0 ‚Äî –ü–ï–†–ï–•–í–ê–¢ –ü–ê–ö–ï–¢–û–í</span>
      <span id="timer">00:30</span>
    </div>
    
    <div class="difficulty">
      <button class="difficulty-btn active" data-level="easy">üü¢ –õ–µ–≥–∫–æ (70%)</button>
      <button class="difficulty-btn" data-level="medium">üü† –°—Ä–µ–¥–Ω–µ (50%)</button>
      <button class="difficulty-btn" data-level="hard">üî¥ –°–ª–æ–∂–Ω–æ (30%)</button>
    </div>
    
    <div id="game-area">
      <!-- –°—é–¥–∞ –±—É–¥–µ—Ç –ø–æ–¥–≥—Ä—É–∂–∞—Ç—å—Å—è –º–∏–Ω–∏-–∏–≥—Ä–∞ -->
    </div>
    
    <div class="progress-bar">
      <div class="progress-fill" id="progress"></div>
    </div>
    
    <button class="hack-btn" id="hackBtn" disabled>üöÄ –í–´–ü–û–õ–ù–ò–¢–¨ –í–ó–õ–û–ú</button>
    <div class="hint">‚ö†Ô∏è –í—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å. –û—à–∏–±–∫–∞ = –æ—Ç–∫–∞—Ç.</div>
  </div>

  <script>
    const Telegram = window.Telegram.WebApp;
    Telegram.expand();
    Telegram.MainButton.hide();
    
    let currentDifficulty = 'easy';
    let targetSequence = [];
    let userSequence = [];
    let attempts = 0;
    
    const difficulties = {
      easy: { length: 3, time: 30, reward: 1 },
      medium: { length: 5, time: 45, reward: 3 },
      hard: { length: 8, time: 60, reward: 6 }
    };
    
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –¥–ª—è –≤–∑–ª–æ–º–∞
    function generateSequence(length) {
      const chars = ['0x7F', '0x3A', '0xC2', '0x91', '0x4D', '0xE5', '0xB8', '0x2F'];
      const sequence = [];
      for (let i = 0; i < length; i++) {
        sequence.push(chars[Math.floor(Math.random() * chars.length)]);
      }
      return sequence;
    }
    
    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –∏–≥—Ä—ã
    function renderGame() {
      const gameArea = document.getElementById('game-area');
      const diff = difficulties[currentDifficulty];
      
      targetSequence = generateSequence(diff.length);
      userSequence = [];
      
      let html = '<div style="margin-bottom: 20px;">üéØ –¶–µ–ª–µ–≤–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:<br><br>';
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ü–µ–ª—å –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ
      html += targetSequence.map(code => 
        `<span style="color: #00ff9d; font-size: 20px; margin: 0 5px;">${code}</span>`
      ).join('');
      
      html += '</div><div style="margin: 30px 0 20px;">üîß –¢–≤–æ–π –∫–æ–¥:<br><br><div id="user-sequence">';
      
      if (userSequence.length === 0) {
        html += '<span style="color: #666;">[–æ–∂–∏–¥–∞–Ω–∏–µ –≤–≤–æ–¥–∞]</span>';
      } else {
        html += userSequence.map(code => 
          `<span style="color: #ffaa00; font-size: 20px; margin: 0 5px;">${code}</span>`
        ).join('');
      }
      
      html += '</div></div><div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px;">';
      
      // –ö–Ω–æ–ø–∫–∏ –¥–ª—è –≤–≤–æ–¥–∞
      const chars = ['0x7F', '0x3A', '0xC2', '0x91', '0x4D', '0xE5', '0xB8', '0x2F'];
      chars.forEach(char => {
        html += `<button onclick="addCode('${char}')" style="
          padding: 15px;
          background: transparent;
          border: 1px solid #00ff9d;
          color: #00ff9d;
          font-family: monospace;
          cursor: pointer;
          border-radius: 5px;
        ">${char}</button>`;
      });
      
      html += '</div><button onclick="clearSequence()" style="
        width: 100%;
        padding: 10px;
        margin-top: 20px;
        background: transparent;
        border: 1px solid #ff3366;
        color: #ff3366;
        cursor: pointer;
        border-radius: 5px;
      ">‚úó –°–±—Ä–æ—Å–∏—Ç—å</button>';
      
      gameArea.innerHTML = html;
      
      // –¢–∞–π–º–µ—Ä
      startTimer(diff.time);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–Ω–æ–ø–∫–∏ –≤–∑–ª–æ–º–∞
      document.getElementById('hackBtn').disabled = userSequence.length !== diff.length;
    }
    
    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
    function addCode(code) {
      const diff = difficulties[currentDifficulty];
      if (userSequence.length < diff.length) {
        userSequence.push(code);
        renderGame();
      }
    }
    
    // –°–±—Ä–æ—Å
    function clearSequence() {
      userSequence = [];
      renderGame();
    }
    
    // –¢–∞–π–º–µ—Ä
    function startTimer(seconds) {
      const timerEl = document.getElementById('timer');
      let timeLeft = seconds;
      
      const interval = setInterval(() => {
        timeLeft--;
        timerEl.textContent = `00:${timeLeft.toString().padStart(2, '0')}`;
        
        if (timeLeft <= 0) {
          clearInterval(interval);
          timerEl.textContent = '00:00';
          document.getElementById('hackBtn').disabled = true;
        }
      }, 1000);
    }
    
    // –°–º–µ–Ω–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
    document.querySelectorAll('.difficulty-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.difficulty-btn').forEach(b => 
          b.classList.remove('active')
        );
        this.classList.add('active');
        currentDifficulty = this.dataset.level;
        renderGame();
      });
    });
    
    // –í–∑–ª–æ–º
    document.getElementById('hackBtn').addEventListener('click', function() {
      const isSuccess = JSON.stringify(userSequence) === JSON.stringify(targetSequence);
      
      Telegram.sendData(JSON.stringify({
        success: isSuccess,
        difficulty: currentDifficulty,
        attempts: attempts + 1,
        reward: isSuccess ? difficulties[currentDifficulty].reward : 0
      }));
    });
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    renderGame();
  </script>
</body>
</html>
